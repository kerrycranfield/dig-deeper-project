<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>q2_feature_table : summarize</title>
    <link rel="stylesheet" href="./q2templateassets/css/bootstrap.min.css"/>
    <link rel="stylesheet" href="./q2templateassets/css/normalize.css"/>
    <link rel="stylesheet" href="./q2templateassets/css/base-template.css"/>
    <script src="./q2templateassets/js/jquery-3.2.0.min.js" charset="utf-8"></script>
    <script src="./q2templateassets/js/bootstrap.min.js" charset="utf-8"></script>
    
<script src="js/vega.min.js"></script>
<script src="js/vega-embed.min.js"></script>
<link rel="stylesheet" type="text/css" href="css/spinkit.css" /> 
  </head>
  <body>
    <div class="container-fluid">
      <div id="q2templatesheader" class="row">
        <div class="col-lg-12">
          <a href="http://qiime2.org/">
            <img src="./q2templateassets/img/qiime2-rect-200.png"
            alt="QIIME 2">
          </a>
        </div>
      </div>
        

  <div class="row">
    <div class="col-lg-12">
      <ul class="nav nav-tabs">
        
          <li class="">
            <a href="index.html">
              Overview
            </a>
          </li>
        
          <li class="active">
            <a href="sample-frequency-detail.html">
              Interactive Sample Detail
            </a>
          </li>
        
          <li class="">
            <a href="feature-frequency-detail.html">
              Feature Detail
            </a>
          </li>
        
      </ul>
    </div>
  </div>
  <div class="row">
    <div class="col-lg-12">
      


<div class="row">
  <div class="col-lg-4">
    <div class="row">
      <div class="col-lg-12" id="sampling-depth-slider">
        <label> Sampling Depth &nbsp; </label> <br>
        <input id="range-slider" type="range" min="0" max="67830.0" value="0" class="slider" oninput="sliderHelperFunction(this.value);"> <br>
        <input id="text-box" class="form-control" type="number" value="0" min="0" oninput="textBoxHelperFunction(this.value);"/>
        <br>
        (zero implies no even sampling)
        <div class="row">
          <div class="col-lg-12" id="text-field"></div>
        </div>
      </div>
    </div>
  </div>
</div>



<div class="row">
  <div class="col-lg-8">
    <table id="feature-table" class="table table-striped">
      <thead>
        <tr>
          <th scope="col">Sample ID</th>
          <th scope="col">Feature Count</th>
        </tr>
      </thead>
      <tbody id="table-body"></tbody>
    </table>
  </div>
</div>

<script id="table-data" type="application/json">
{"GP460":67830.0,"GP420":56831.0,"GP453":56611.0,"GP298":55875.0,"GP252":54711.0,"GP273":54402.0,"GP166":53172.0,"GP215":53119.0,"GP183":52406.0,"GP306":52018.0,"GP249":51581.0,"GP151":51173.0,"GP323":49800.0,"GP304":49648.0,"GP179":49592.0,"GP226":49206.0,"GP236":49148.0,"GP209":48917.0,"GP302":48589.0,"GP212":48511.0,"GP163":48273.0,"GP303":48051.0,"GP326":48044.0,"GP210":47962.0,"GP175":47831.0,"GP231":47669.0,"GP331":47629.0,"GP171":47613.0,"GP208":47401.0,"GP251":46972.0,"GP162":46950.0,"GP170":46721.0,"GP427":46655.0,"GP305":46572.0,"GP220":46559.0,"GP192":46306.0,"GP213":46275.0,"GP275":46183.0,"GP314":46067.0,"GP311":46059.0,"GP164":46036.0,"GP195":45930.0,"GP181":45888.0,"GP241":45782.0,"GP301":45733.0,"GP250":45716.0,"GP454":45515.0,"GP165":45404.0,"GP199":45392.0,"GP176":45294.0,"GP307":45185.0,"GP325":45173.0,"GP200":45058.0,"GP276":44964.0,"GP280":44952.0,"GP281":44806.0,"GP161":44655.0,"GP321":44617.0,"GP188":44593.0,"GP426":44572.0,"GP313":44486.0,"GP286":44331.0,"GP316":44132.0,"GP174":44129.0,"GP238":44107.0,"GP160":44102.0,"GP157":43970.0,"GP245":43954.0,"GP254":43893.0,"GP198":43892.0,"GP217":43805.0,"GP185":43769.0,"GP290":43759.0,"GP324":43703.0,"GP274":43629.0,"GP267":43590.0,"GP315":43507.0,"GP172":43383.0,"GP318":43339.0,"GP225":43050.0,"GP243":42969.0,"GP263":42919.0,"GP191":42872.0,"GP287":42737.0,"GP232":42718.0,"GP207":42679.0,"GP235":42585.0,"GP189":42526.0,"GP239":42505.0,"GP322":42430.0,"GP156":42350.0,"GP240":42324.0,"GP248":42257.0,"GP224":42205.0,"GP214":42104.0,"GP466":42071.0,"GP229":41943.0,"GP269":41885.0,"GP279":41872.0,"GP216":41775.0,"GP177":41481.0,"GP203":41430.0,"GP153":41395.0,"GP465":41369.0,"GP190":41341.0,"GP288":41026.0,"GP242":40994.0,"GP193":40965.0,"GP228":40857.0,"GP319":40850.0,"GP272":40828.0,"GP296":40801.0,"GP196":40756.0,"GP219":40696.0,"GP184":40608.0,"GP180":40515.0,"GP152":40514.0,"GP230":40445.0,"GP202":40377.0,"GP246":40370.0,"GP187":40298.0,"GP197":40216.0,"GP270":40131.0,"GP237":40117.0,"GP173":40077.0,"GP186":39950.0,"GP227":39895.0,"GP204":39854.0,"GP218":39821.0,"GP158":39481.0,"GP234":39461.0,"GP265":39211.0,"GP206":38815.0,"GP182":38755.0,"GP205":38661.0,"GP178":38452.0,"GP159":38299.0,"GP244":38117.0,"GP201":37923.0,"GP260":37861.0,"GP247":37699.0,"GP168":37687.0,"GP367":37655.0,"GP221":37504.0,"GP332":37289.0,"GP430":37266.0,"GP194":37016.0,"GP312":36817.0,"GP233":36803.0,"GP149":36335.0,"GP262":36152.0,"GP261":35860.0,"GP320":35843.0,"GP294":35302.0,"GP271":35284.0,"GP330":35179.0,"GP223":34934.0,"GP327":34717.0,"GP211":34526.0,"GP256":33868.0,"GP392":32760.0,"GP284":32476.0,"GP148":32243.0,"GP222":31675.0,"GP285":31430.0,"GP310":31382.0,"GP300":31001.0,"GP328":29963.0,"GP406":29777.0,"GP292":29547.0,"GP291":29515.0,"GP297":29469.0,"GP339":29405.0,"GP150":29251.0,"GP308":29096.0,"GP410":28819.0,"GP282":28807.0,"GP433":28013.0,"GP415":26932.0,"GP396":26752.0,"GP309":26677.0,"GP428":26497.0,"GP413":26367.0,"GP411":26203.0,"GP431":26177.0,"GP169":26149.0,"GP391":26129.0,"GP409":25857.0,"GP408":25819.0,"GP417":25797.0,"GP155":25750.0,"GP341":25661.0,"GP435":25632.0,"GP333":25315.0,"GP264":25201.0,"GP403":24927.0,"GP167":24726.0,"GP334":24299.0,"GP299":24243.0,"GP357":24212.0,"GP400":24070.0,"GP154":24009.0,"GP369":23803.0,"GP383":23784.0,"GP361":23723.0,"GP258":23593.0,"GP365":23454.0,"GP398":23404.0,"GP356":23285.0,"GP329":23174.0,"GP423":23082.0,"GP371":23000.0,"GP407":22891.0,"GP419":22858.0,"GP382":22742.0,"GP335":22680.0,"GP397":22575.0,"GP372":22542.0,"GP378":22445.0,"GP259":22358.0,"GP412":22292.0,"GP414":22203.0,"GP364":22151.0,"GP421":22050.0,"GP368":22032.0,"GP386":21963.0,"GP388":21663.0,"GP457":21584.0,"GP404":21466.0,"GP278":21432.0,"GP293":21408.0,"GP422":21319.0,"GP418":21226.0,"GP394":21186.0,"GP366":21134.0,"GP344":20853.0,"GP401":20770.0,"GP381":20728.0,"GP340":20654.0,"GP358":20632.0,"GP257":20587.0,"GP354":20558.0,"GP355":20488.0,"GP416":20478.0,"GP395":20458.0,"GP405":20444.0,"GP402":20341.0,"GP393":20296.0,"GP277":20265.0,"GP363":20115.0,"GP268":20074.0,"GP343":20007.0,"GP425":19944.0,"GP353":19916.0,"GP377":19891.0,"GP337":19883.0,"GP399":19848.0,"GP342":19801.0,"GP347":19685.0,"GP380":19685.0,"GP346":19620.0,"GP384":19615.0,"GP359":19587.0,"GP379":19578.0,"GP351":19509.0,"GP348":19466.0,"GP373":19445.0,"GP442":19435.0,"GP253":19359.0,"GP472":19283.0,"GP376":19070.0,"GP389":19067.0,"GP349":18966.0,"GP390":18966.0,"GP452":18820.0,"GP317":18812.0,"GP424":18807.0,"GP469":18682.0,"GP266":18652.0,"GP385":18531.0,"GP350":18519.0,"GP352":18342.0,"GP283":18266.0,"GP362":18215.0,"GP360":18094.0,"GP475":17953.0,"GP374":17910.0,"GP375":17830.0,"GP436":17730.0,"GP441":17728.0,"GP387":17686.0,"GP438":17551.0,"GP336":17511.0,"GP451":17506.0,"GP448":17383.0,"GP467":17102.0,"GP434":16934.0,"GP471":16717.0,"GP447":16690.0,"GP449":16591.0,"GP450":16570.0,"GP338":16555.0,"GP443":16554.0,"GP439":16547.0,"GP456":16495.0,"GP474":16221.0,"GP440":16193.0,"GP455":16142.0,"GP437":16045.0,"GP468":16044.0,"GP446":15844.0,"GP464":15766.0,"GP463":15412.0,"GP345":15232.0,"GP470":15143.0,"GP473":14872.0,"GP255":14518.0,"GP289":14139.0,"GP461":13974.0,"GP370":13707.0,"GP295":11547.0,"GP429":10266.0,"GP462":9340.0}
</script>

<script type="text/javascript">
  var totalFrequencies = 10434789;
  var sampleCount = 323;
  var defaultDescription = "Retained " + (totalFrequencies.toLocaleString('en'))
                                       + " (100.00%) features in "
                                       + sampleCount + " (100.00%) samples at the specifed sampling depth.";


  var textField = document.getElementById('text-field');
  var tableBody = document.getElementById("table-body");
  var table = document.getElementById("feature-table");

  // when the viz loads the default description is displayed
  textField.innerHTML = defaultDescription;

  var sampleFrequency = JSON.parse(document.getElementById("table-data").innerHTML);
  // get object keys and store them in an ascending order based on the key value
  // this order is used to create the table rows
  sortedSampleIDs = Object.keys(sampleFrequency).sort(function(a, b) {
    var temp = sampleFrequency[a] - sampleFrequency[b];
    // if two samples have the same number of features then we
    // determine the order using the sample ID alphabetical order
    if (temp == 0){
      return b.localeCompare(a);
    }

  return temp;
  });

  sortedSampleIDs.forEach(function(element) {
    var row = tableBody.insertRow(0);
    var cell1 = row.insertCell(0);
    var cell2 = row.insertCell(1);
    cell1.innerHTML = element;
    cell2.innerHTML = sampleFrequency[element];

  });


  function updateTableandText(val) {
    var retainedSampleCount = 0;

    // start the counter at 1 to ignore the header row
    for (var i = 1; row = table.rows[i]; i++) {

      if (Number(row.cells[1].innerHTML) < val) {
        row.className = "danger";
      } else {
        row.className = "";
        retainedSampleCount += 1;
      }
    }
    if (val == 0){

    textField.innerHTML = defaultDescription;

    }
    else{
      var retainedFeatureCount = retainedSampleCount * val;
      textField.innerHTML = "Retained " + retainedFeatureCount.toLocaleString('en')
                                        + " (" + (retainedFeatureCount/totalFrequencies*100).toFixed(2) + "%) features in "
                                        + retainedSampleCount + " (" + (retainedSampleCount/sampleCount*100).toFixed(2)
                                        +  "%) samples at the specifed sampling depth.";
    }

  }


  function updateSliderVal(val) {
    var slider = document.getElementById("range-slider");
    slider.value = val;
    slider.dispatchEvent(new Event("change"));
    slider.dispatchEvent(new Event("input"));
  }


  function updateBoxVal(val) {
    var num = document.getElementById("text-box");
    num.value = val;
  }


  function sliderHelperFunction(val){
    updateBoxVal(val);
    updateTableandText(val);

  }


  function textBoxHelperFunction(val){
    val = parseInt(val);
    if (val !== val) {
      val = 0;
    }

    // make sure the value in the textbox cannot exceed the max count
    if (val > 67830.0){
      var num = document.getElementById("text-box");
      num.value = 67830.0;
    }
    updateSliderVal(val);
  }
</script>


    </div>
  </div>


    </div>
    <script type="text/javascript">
      if (window.frameElement) {
          document.getElementById('q2templatesheader').remove();
      }
    </script>
    

  </body>
</html>